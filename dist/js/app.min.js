!function e(n,o,a){function r(s,i){if(!o[s]){if(!n[s]){var l="function"==typeof require&&require;if(!i&&l)return l(s,!0);if(t)return t(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var u=o[s]={exports:{}};n[s][0].call(u.exports,function(e){var o=n[s][1][e];return r(o?o:e)},u,u.exports,e,n,o,a)}return o[s].exports}for(var t="function"==typeof require&&require,s=0;s<a.length;s++)r(a[s]);return r}({1:[function(e){var n=e("./viewmodel/app-viewmodel.js"),o=new n;o.init().then(function(){ko.applyBindings(o)})},{"./viewmodel/app-viewmodel.js":3}],2:[function(e,n){n.exports=function(e){this.name=ko.observable(e.name),this.lat=ko.observable(e.lat),this.lng=ko.observable(e.lng),this.foursquareId=ko.observable(e.foursquareId),this.marker}},{}],3:[function(e,n){(function(o){var a=e("../model/Place.js"),r=e("./map-viewmodel.js");n.exports=function(){var e=this;return e.MAP_ERROR_TEMPLATE=$("[data-template=maps-error]").html(),e.places=ko.observableArray([]),e.search=ko.observable(""),"undefined"==typeof o.google?void $("#map-canvas").html(e.MAP_ERROR_TEMPLATE):(e.mapViewModel=new r("map-canvas"),e.init=function(){return $.getJSON("places.json").then(function(n){var o=$.map(n,function(e){return new a(e)});e.places(o),e.mapViewModel.initMarkers(e.places)})},e.filteredPlaces=ko.computed(function(){var n=e.search().toLowerCase();return ko.utils.arrayFilter(e.places(),function(e){var o=e.name().toLowerCase();return o.indexOf(n)>-1}).sort(function(e,n){return lName=e.name().toLowerCase(),rName=n.name().toLowerCase(),lName==rName?0:lName<rName?-1:1})}),e.filteredPlaces.subscribe(function(n){e.mapViewModel.updateMarkers(n)}),void(e.selectPlaceFromList=function(n){$(".navmenu.canvas-slid").offcanvas("hide"),e.mapViewModel.showPlace(n)}))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../model/Place.js":2,"./map-viewmodel.js":5}],4:[function(e,n){n.exports=function(){var e=this;e.PLACE_TEMPLATE=$("[data-template=place-foursquare]").html(),e.API_URL="https://api.foursquare.com/v2/venues/{{venueId}}?client_id=GYEK0PESSPOVGTN1AYR0XFPTHGPVGZDICA1ELEUZQ0M3MUFR&client_secret=JGKE1IPGETB11KPSWTP05HKMY0SF3ZQ4ENPIFD1HYVPY0JVF&v=20130815",e.loadPlaceInfo=function(n){var o=e.API_URL.replace("{{venueId}}",n);return $.getJSON(o).then(function(n){var o={};return o.name=n.response.venue.name||"",o.url=n.response.venue.shortUrl||"",o.rating=n.response.venue.rating||0,o.address=n.response.venue.location.formattedAddress[0]||"",o.city=n.response.venue.location.formattedAddress[1]||"",o.likes=n.response.venue.likes.count||0,o.photo=n.response.venue.bestPhoto.prefix,o.photo+="120x120",o.photo+=n.response.venue.bestPhoto.suffix,o.tips=n.response.venue.tips.groups[0].items[0].text||"",e.processTemplate(o)})},e.processTemplate=function(n){var o=e.PLACE_TEMPLATE;return o=o.replace("{{place.name}}",n.name),o=o.replace("{{place.url}}",n.url),o=o.replace("{{place.rating}}",n.rating),o=o.replace("{{place.address}}",n.address),o=o.replace("{{place.city}}",n.city),o=o.replace("{{place.likes}}",n.likes),o=o.replace("{{place.photo}}",n.photo),o=o.replace("{{place.tips}}",n.tips)}}},{}],5:[function(e,n){var o=e("./foursquare-viewmodel.js");n.exports=function(e){var n=this;n.PLACE_LOADING_TEMPLATE=$("[data-template=place-loading]").html(),n.PLACE_ERROR_TEMPLATE=$("[data-template=place-error]").html(),n.foursquareViewModel=new o,n.infoWindow=new google.maps.InfoWindow;var a=document.getElementById(e);n.map=new google.maps.Map(a,{zoom:12,center:new google.maps.LatLng(31.755,-106.44)}),n.places=ko.observableArray([]),n.initMarkers=function(e){n.places=e,ko.utils.arrayForEach(e(),function(e){e.marker=new google.maps.Marker({position:new google.maps.LatLng(e.lat(),e.lng()),map:n.map,title:e.name()}),google.maps.event.addListener(e.marker,"click",function(){n.showPlace(e)})})},n.updateMarkers=function(e){ko.utils.arrayForEach(n.places(),function(o){e.indexOf(o)>-1&&!o.marker.map?o.marker.setMap(n.map):-1==e.indexOf(o)&&o.marker.map&&o.marker.setMap(null)})},n.showPlace=function(e){n.infoWindow.setContent(n.PLACE_LOADING_TEMPLATE),n.foursquareViewModel.loadPlaceInfo(e.foursquareId()).then(function(e){n.infoWindow.setContent(e)},function(){n.infoWindow.setContent(n.PLACE_ERROR_TEMPLATE)}),n.infoWindow.open(n.map,e.marker),e.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.marker.setAnimation(null)},700)}}},{"./foursquare-viewmodel.js":4}]},{},[1]);